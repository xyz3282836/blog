import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as n,o as t}from"./app-rFP3mJQ8.js";const e="/assets/image-20230722232025216-dyGkqysa.png",l={};function h(k,i){return t(),a("div",null,i[0]||(i[0]=[n(`<h3 id="å®¢æˆ·ç«¯é…ç½®" tabindex="-1"><a class="header-anchor" href="#å®¢æˆ·ç«¯é…ç½®"><span>å®¢æˆ·ç«¯é…ç½®</span></a></h3><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ClientParameters</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// After a duration of this time if the client doesn&#39;t see any activity it</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// pings the server to see if the transport is still alive.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// If set below 10s, a minimum value of 10s will be used instead.</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	Time</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Duration</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // The current default value is infinity.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// After having pinged for keepalive check, the client waits for a duration</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// of Timeout and if no activity is seen even after that the connection is</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// closed.</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	Timeout</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Duration</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // The current default value is 20 seconds.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// If true, client sends keepalive pings even with no active RPCs. If false,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// when there are no active RPCs, Time and Timeout will be ignored and no</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// keepalive pings will be sent.</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	PermitWithoutStream</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> bool</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // false by default.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Timeï¼š<strong>æ²¡æœ‰æ´»åŠ¨åçš„ä¿æ´»æ—¶é—´</strong>ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´å°±ä¼šå‘pingç»™serverï¼›<code>é»˜è®¤æ— ç©·å¤§ï¼Œæœ€å°10s</code>ï¼Œé»˜è®¤è¿æ¥ä¸€ç›´è®¤ä¸ºæœ‰æ•ˆï¼ˆBç«™è®¾ç½®60sï¼‰</p><p>Timeoutï¼š<strong>pingåç­‰å¾…æ—¶é—´</strong>ï¼Œè¶…è¿‡å°±æ–­å¼€è¿æ¥ï¼›é»˜è®¤<code>20s</code>ï¼ˆBç«™è®¾ç½®20sï¼‰</p><p>PermitWithoutStreamï¼štrueï¼Œ<strong>è¿æ¥åœ¨æ²¡æ´»åŠ¨æ—¶ä¼šå®šæœŸå‘ping</strong>ï¼Œç»“åˆä¸Šé¢ğŸ‘†ä¸¤ä¸ªå‚æ•°ï¼›é»˜è®¤ä¸º<code>false</code>ï¼ˆBç«™æ²¡æœ‰è®¾ç½®ï¼Œé»˜è®¤falseï¼‰</p><h3 id="æœåŠ¡ç«¯é…ç½®" tabindex="-1"><a class="header-anchor" href="#æœåŠ¡ç«¯é…ç½®"><span>æœåŠ¡ç«¯é…ç½®</span></a></h3><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ServerParameters</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// MaxConnectionIdle is a duration for the amount of time after which an</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// idle connection would be closed by sending a GoAway. Idleness duration is</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// defined since the most recent time the number of outstanding RPCs became</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// zero or the connection establishment.</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	MaxConnectionIdle</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Duration</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // The current default value is infinity.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// MaxConnectionAge is a duration for the maximum amount of time a</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// connection may exist before it will be closed by sending a GoAway. A</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// random jitter of +/-10% will be added to MaxConnectionAge to spread out</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// connection storms.</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	MaxConnectionAge</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Duration</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // The current default value is infinity.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// MaxConnectionAgeGrace is an additive period after MaxConnectionAge after</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// which the connection will be forcibly closed.</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	MaxConnectionAgeGrace</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Duration</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // The current default value is infinity.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// After a duration of this time if the server doesn&#39;t see any activity it</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// pings the client to see if the transport is still alive.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// If set below 1s, a minimum value of 1s will be used instead.</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	Time</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Duration</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // The current default value is 2 hours.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// After having pinged for keepalive check, the server waits for a duration</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// of Timeout and if no activity is seen even after that the connection is</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// closed.</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	Timeout</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Duration</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // The current default value is 20 seconds.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>MaxConnectionIdleï¼š<strong>idleç©ºé—²è¿æ¥çš„å­˜æ´»æ—¶é—´</strong>ï¼Œè¶…è¿‡å°±å‘é€GoAwayå¸§ï¼ˆç©ºé—²è¿æ¥çš„å®šä¹‰å°±æ˜¯æœ€è¿‘ä¸€æ¬¡rpcè°ƒç”¨ä¹‹åçš„æ—¶é—´ï¼Œæˆ–è€…è¿æ¥åˆšåˆšå»ºç«‹ä½œä¸ºèµ·ç‚¹è®¡ç®—æ²¡æœ‰rpcè°ƒç”¨çš„ç»´æŒæ—¶é—´ï¼‰ï¼›é»˜è®¤<code>æ— é™å¤§</code>ï¼Œé»˜è®¤è¿æ¥æ— çº¿å­˜æ´»ï¼ˆBç«™è®¾ç½®60sï¼‰</p><p>MaxConnectionAgeï¼š<strong>è¿æ¥çš„æœ€å¤§å­˜æ´»æ—¶é—´</strong>ï¼ŒåŒ…æ‹¬æ´»è·ƒè¿æ¥å’Œç©ºé—²è¿æ¥ï¼Œæ¯”ä¸Šé¢ğŸ‘†åº”è¯¥è¦é•¿ç‚¹ï¼Œè¶…äº†è¦å‘é€GoAwayå¸§ï¼Œå¹¶ä¸”é˜²æ­¢åŒæ—¶å…³é—­è¿‡å¤šè¿æ¥ï¼ŒåŠ äº†éšæœºæ‰°åŠ¨ä¸Šä¸‹10%çš„æ—¶é—´ï¼›é»˜è®¤<code>æ— é™å¤§</code>ï¼Œé»˜è®¤è¿æ¥æ— çº¿å­˜æ´»ï¼ˆBç«™è®¾ç½®2å°æ—¶ï¼‰</p><p>MaxConnectionAgeGraceï¼šæœåŠ¡ä¸Šé¢ï¼Œåˆ°äº†æ—¶é—´ä½†æ˜¯ä¼šç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œæ¥ä¼˜é›…å…³é—­ï¼Œä¸»è¦ä¸ºäº†æœ‰rpcçš„æƒ…å†µï¼Œè®©å…¶é¡ºåˆ©ç»“æŸï¼›é»˜è®¤æ— é™å¤§ï¼ˆBç«™è®¾ç½®20sï¼‰</p><p>Timeï¼š<strong>æ²¡æœ‰æ´»åŠ¨åçš„ä¿æ´»æ—¶é—´</strong>ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´å°±ä¼šå‘pingç»™clientï¼›é»˜è®¤2å°æ—¶ï¼Œæœ€å°1sï¼Œé»˜è®¤åªè®¤ä¸ºå’Œå®¢æˆ·ç«¯ä¿æ´»<code>2å°æ—¶</code>ï¼ˆBç«™è®¾ç½®60sï¼‰ï¼ˆBç«™è®¾ç½®60sï¼‰</p><p>Timeoutï¼š<strong>pingåç­‰å¾…æ—¶é—´</strong>ï¼Œè¶…è¿‡å°±æ–­å¼€è¿æ¥ï¼›é»˜è®¤<code>20s</code>ï¼ˆBç«™è®¾ç½®20sï¼‰</p><h4 id="æœåŠ¡ç«¯è‡ªæˆ‘ä¿æŠ¤ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#æœåŠ¡ç«¯è‡ªæˆ‘ä¿æŠ¤ç­–ç•¥"><span>æœåŠ¡ç«¯è‡ªæˆ‘ä¿æŠ¤ç­–ç•¥</span></a></h4><p>Bç«™æ²¡æœ‰è®¾ç½®</p><p>ä¸ºäº†ä¿æŠ¤serverç«¯ï¼Œé™åˆ¶å®¢æˆ·ç«¯çš„pingçš„é¢‘ç‡ï¼ˆ<strong>ç­‰å®¢æˆ·ç«¯4æ¬¡pingæ¥ç»Ÿè®¡æ¯”è¾ƒ</strong>ï¼‰</p><p>MinTimeï¼š<strong>å®¢æˆ·ç«¯å¯ä»¥å‘é€pingçš„æœ€å°é—´éš”</strong>ï¼›é»˜è®¤æ˜¯<code>5min</code>ï¼›éœ€è¦<code>ç­‰å®¢æˆ·ç«¯4æ¬¡ping</code>ï¼Œæ¥æ¯”è¾ƒMinTimeï¼Œä¸ç¬¦åˆå°±å‘é€GoAwayå¸§</p><p>PermitWithoutStreamï¼štrueï¼Œå…è®¸æ²¡æœ‰rpcè°ƒç”¨æ—¶clientå‘é€pingï¼›é»˜è®¤<code>false</code>ä¸å…è®¸ï¼Œå¦‚æœç©ºé—´æ—¶é—´å®¢æˆ·ç«¯å‘pingï¼Œé‚£ä¹ˆserverä¼šå‘é€GoAwayå¸§æ¥å…³é—­è¿æ¥ï¼›falseçŠ¶æ€ä¸‹ï¼Œéœ€è¦<code>ç­‰å®¢æˆ·ç«¯4æ¬¡ping</code>ï¼Œæ‰ä¼šå‘é€GoAwayå¸§</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">SETTINGS</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:41:43</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Framer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x14000198000:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wrote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SETTINGS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:41:43</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Framer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x14000198000:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> read</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SETTINGS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len=6,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> settings:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MAX_FRAME_SIZE=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">16384</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:41:43</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Framer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x14000198000:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wrote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SETTINGS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flags=ACK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:41:43</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Framer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x14000198000:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> read</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SETTINGS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flags=ACK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">PING-1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:42:16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Framer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x14000198000:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wrote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PING</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ping=&quot;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:42:16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Framer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x14000198000:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> read</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PING</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flags=ACK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ping=&quot;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">PING-2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:42:49</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Framer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x14000198000:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wrote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PING</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ping=&quot;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:42:49</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Framer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x14000198000:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> read</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PING</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flags=ACK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ping=&quot;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">PING-3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:43:22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Framer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x14000198000:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wrote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PING</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ping=&quot;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:43:22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Framer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x14000198000:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> read</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PING</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flags=ACK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ping=&quot;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">PING-4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:43:55</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Framer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x14000198000:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wrote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PING</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ping=&quot;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:43:55</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Framer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x14000198000:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> read</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PING</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flags=ACK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ping=&quot;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">æœåŠ¡ä¾§å‘æ¥GOAWAY</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:43:55</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Framer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x14000198000:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> read</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GOAWAY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> LastStreamID=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ErrCode=ENHANCE_YOUR_CALM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Debug=&quot;too_many_pings&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2023/07/22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12:43:55</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ERROR:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [transport] Client received GoAway with error code ENHANCE_YOUR_CALM and debug data equal to ASCII </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;too_many_pings&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>43ç§’å¼€å§‹ï¼Œ16ç¬¬ä¸€æ¬¡pingï¼Œ49ç¬¬äºŒæ¬¡pingï¼Œ22ç¬¬ä¸‰æ¬¡pingï¼Œ55ç¬¬å››æ¬¡pingï¼ŒåŒæ—¶å‘é€GoAwayå¸§</p><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// EnforcementPolicy is used to set keepalive enforcement policy on the</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// server-side. Server will close connection with a client that violates this</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// policy.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> EnforcementPolicy</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// MinTime is the minimum amount of time a client should wait before sending</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// a keepalive ping.</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	MinTime</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Duration</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // The current default value is 5 minutes.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// If true, server allows keepalive pings even when there are no active</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// streams(RPCs). If false, and client sends ping when there are no active</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// streams, server will send GOAWAY and close the connection.</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	PermitWithoutStream</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> bool</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // false by default.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>demoä»£ç æ¼”ç¤ºï¼šhttps://github.com/xyz3282836/grpcdemo/tree/master/libtest</p><p>å¯ä»¥å¼€å¯GODEBUG</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> GODEBUG</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">http2client</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # disable HTTP/2 client support</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> GODEBUG</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">http2server</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # disable HTTP/2 server support</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> GODEBUG</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">http2debug</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # enable verbose HTTP/2 debug logs</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> GODEBUG</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">http2debug</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # ... even more verbose, with frame dumps</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸€æ¬¡æ™®é€šè¯·æ±‚ï¼Œæ”¶å‘åŒ…çš„å¸§æ—¥å¿—</p><p>æœåŠ¡ç«¯é…ç½®ï¼Œç¬¬ä¸€ä¸ªEnforcementPolicy.PermitWithoutStreamä¸ºfalseï¼Œå…¶å®å°±æ˜¯é»˜è®¤é…ç½®ï¼Œæ­¤é…ç½®ç­‰ä»·äºæ²¡æœ‰é…ç½®ï¼Œç›´æ¥çœ‹ç¬¬äºŒä¸ªé…ç½®å°±å¥½</p><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> kaep</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> =</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> keepalive</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">EnforcementPolicy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	MinTime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:             </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Second</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// If a client pings more than once every 5 seconds, terminate the connection</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	PermitWithoutStream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,             </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Allow pings even when there are no active streams</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> kasp</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> =</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> keepalive</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">ServerParameters</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	MaxConnectionIdle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:     </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5000</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Second</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// If a client is idle for 15 seconds, send a GOAWAY</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	MaxConnectionAge</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:      </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6000</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Second</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// If any connection is alive for more than 30 seconds, send a GOAWAY</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	MaxConnectionAgeGrace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Second</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,    </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Allow 5 seconds for pending RPCs to complete before forcibly closing connections</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	Time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:                  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">15</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Second</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,    </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Ping the client if it is idle for 5 seconds to ensure the connection is still active</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	Timeout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:               </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Second</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,    </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Wait 1 second for the ping ack before assuming the connection is dead</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®¢æˆ·ç«¯é…ç½®ï¼ŒTimeè¶…è¿‡æœåŠ¡ä¾§ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯å‘èµ·ping</p><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> kacp</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> =</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> keepalive</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">ClientParameters</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	Time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:                </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Second</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// send pings every 10 seconds if there is no activity</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	Timeout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:             </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Second</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,      </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// wait 1 second for ping ack before considering the connection dead</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	PermitWithoutStream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,             </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// send pings even without active streams</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å·¦è¾¹clientï¼Œå³è¾¹server</p><figure><img src="`+e+'" alt="client-service-fram-logging" tabindex="0" loading="lazy"><figcaption>client-service-fram-logging</figcaption></figure><h2 id="reference" tabindex="-1"><a class="header-anchor" href="#reference"><span>reference</span></a></h2><p>https://zhuanlan.zhihu.com/p/530266840</p><p>https://go.dev/src/net/http/doc.go</p><p>https://pandaychen.github.io/2020/09/01/GRPC-CLIENT-CONN-LASTING/</p>',34)]))}const d=s(l,[["render",h],["__file","keepalive.html.vue"]]),g=JSON.parse('{"path":"/tech/source/grpc/keepalive.html","title":"keepalive","lang":"zh-CN","frontmatter":{"title":"keepalive","date":"2023-07-22T14:40:00.000Z","category":"æŠ€æœ¯","tag":["grpc","keepalive"],"description":"å®¢æˆ·ç«¯é…ç½® Timeï¼šæ²¡æœ‰æ´»åŠ¨åçš„ä¿æ´»æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´å°±ä¼šå‘pingç»™serverï¼›é»˜è®¤æ— ç©·å¤§ï¼Œæœ€å°10sï¼Œé»˜è®¤è¿æ¥ä¸€ç›´è®¤ä¸ºæœ‰æ•ˆï¼ˆBç«™è®¾ç½®60sï¼‰ Timeoutï¼špingåç­‰å¾…æ—¶é—´ï¼Œè¶…è¿‡å°±æ–­å¼€è¿æ¥ï¼›é»˜è®¤20sï¼ˆBç«™è®¾ç½®20sï¼‰ PermitWithoutStreamï¼štrueï¼Œè¿æ¥åœ¨æ²¡æ´»åŠ¨æ—¶ä¼šå®šæœŸå‘pingï¼Œç»“åˆä¸Šé¢ğŸ‘†ä¸¤ä¸ªå‚æ•°ï¼›é»˜è®¤ä¸ºfalseï¼ˆ...","head":[["meta",{"property":"og:url","content":"https://blog.ruizhou.cf/tech/source/grpc/keepalive.html"}],["meta",{"property":"og:site_name","content":"rz blog"}],["meta",{"property":"og:title","content":"keepalive"}],["meta",{"property":"og:description","content":"å®¢æˆ·ç«¯é…ç½® Timeï¼šæ²¡æœ‰æ´»åŠ¨åçš„ä¿æ´»æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´å°±ä¼šå‘pingç»™serverï¼›é»˜è®¤æ— ç©·å¤§ï¼Œæœ€å°10sï¼Œé»˜è®¤è¿æ¥ä¸€ç›´è®¤ä¸ºæœ‰æ•ˆï¼ˆBç«™è®¾ç½®60sï¼‰ Timeoutï¼špingåç­‰å¾…æ—¶é—´ï¼Œè¶…è¿‡å°±æ–­å¼€è¿æ¥ï¼›é»˜è®¤20sï¼ˆBç«™è®¾ç½®20sï¼‰ PermitWithoutStreamï¼štrueï¼Œè¿æ¥åœ¨æ²¡æ´»åŠ¨æ—¶ä¼šå®šæœŸå‘pingï¼Œç»“åˆä¸Šé¢ğŸ‘†ä¸¤ä¸ªå‚æ•°ï¼›é»˜è®¤ä¸ºfalseï¼ˆ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-01-26T16:16:19.000Z"}],["meta",{"property":"article:tag","content":"grpc"}],["meta",{"property":"article:tag","content":"keepalive"}],["meta",{"property":"article:published_time","content":"2023-07-22T14:40:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-01-26T16:16:19.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"keepalive\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-07-22T14:40:00.000Z\\",\\"dateModified\\":\\"2024-01-26T16:16:19.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"ruizhou\\",\\"url\\":\\"https://blog.ruizhou.cf\\"}]}"]]},"headers":[{"level":3,"title":"å®¢æˆ·ç«¯é…ç½®","slug":"å®¢æˆ·ç«¯é…ç½®","link":"#å®¢æˆ·ç«¯é…ç½®","children":[]},{"level":3,"title":"æœåŠ¡ç«¯é…ç½®","slug":"æœåŠ¡ç«¯é…ç½®","link":"#æœåŠ¡ç«¯é…ç½®","children":[{"level":4,"title":"æœåŠ¡ç«¯è‡ªæˆ‘ä¿æŠ¤ç­–ç•¥","slug":"æœåŠ¡ç«¯è‡ªæˆ‘ä¿æŠ¤ç­–ç•¥","link":"#æœåŠ¡ç«¯è‡ªæˆ‘ä¿æŠ¤ç­–ç•¥","children":[]}]},{"level":2,"title":"reference","slug":"reference","link":"#reference","children":[]}],"git":{"createdTime":1706285779000,"updatedTime":1706285779000,"contributors":[{"name":"liuruizhou","email":"liuruizhou@bilibili.com","commits":1}]},"readingTime":{"minutes":5.45,"words":1634},"filePathRelative":"tech/source/grpc/keepalive.md","localizedDate":"2023å¹´7æœˆ22æ—¥","excerpt":"","autoDesc":true}');export{d as comp,g as data};
